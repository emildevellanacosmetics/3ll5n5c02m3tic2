<link rel="stylesheet" type="text/css" href="{{ 'storelocator.css' | asset_url }}" />
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA8j7C8fqe00dry2ADLoqBo_NJY5-n-b-Q&libraries=places"></script>
<script src="{{ 'storelocator.min.js' | asset_url }}" async></script>
<script src="{{ 'storelocator-custom.js' | asset_url }}" defer></script>
<script type="text/javascript">
document.addEventListener('DOMContentLoaded', (event) => {
   // Store locator map overlay  toggle button 
  $('.gmap-toggle-btn').on('click',function(){
    var md = $(this).next('.gmap-overlay');
    if( md.hasClass('hide') ){
      $(this).text('enable map');
      md.removeClass('hide');
    }else{
      $(this).text('disable map');
      md.addClass('hide');
    }
    return false;
  });
});
</script>
<!-- /templates/page.store-locator.liquid -->
<section class="section">
<div class="page-content locations-content">
  <div id="panel"></div>
  <div class="map-canvas-wrapper">
    {% comment %}
    <a class="gmap-toggle-btn map-canvas-toggle-btn" href="javascript:void(0)">enable map</a>
    <div class="gmap-overlay map-canvas-overlay"></div>
    {% endcomment %}
    <div id="map-canvas"></div>
  </div>
</div>
<div class="wrapper">
  <div class="grid">
    <div class="grid__item large--ten-twelfths push--large--one-twelfth">
      <div class="rte rte--nomargin rte--indented-images">
        {{ page.content }}
        <div class="wrapper page-margin store-listing" id="store-listings" style="    border: solid 1px #b1b1b1;
    padding: 15px;">
          <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css" rel="stylesheet"/>
          <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap-theme.min.css" rel="stylesheet"/>
          
          <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
          <p class="datalayer-store" style="    text-transform: uppercase;
    font-size: 18px;
    color: #656565;"><b>Ellana Store Locations - Philippines</b> </p>
          <!--
          <div class="input-group newsletter-form">  
          <input type="text" id="term" class="input-group-field" placeholder="SEARCH STORES" style="color: #b1b1b1;"/>
            <span class="input-group-btn">
            <input type="button" id="find" class="btn uppercase" value="Find"/><div id="labels"><span id="current"></span><span id="count"></span></div>
            </span>
          </div>
		  -->

          <div class="accordion" id="accordion2" style="margin-top: 15px;">

          <div class="panel-heading">
              <a class="accordion-toggle " data-toggle="collapse" data-parent="#accordion2" href="#collapseOne">
                {{ pages.national-capital-region.title }}
              </a>
          </div>
          <div id="collapseOne" class="accordion-body collapse">
            <div class="panel-body">
              {{ pages.national-capital-region.content }}
            </div>
          </div>  

          <div class="panel-heading">
              <a class="accordion-toggle " data-toggle="collapse" data-parent="#accordion2" href="#collapseTwo">
                {{ pages.luzon.title }}
              </a>
          </div>

          <div id="collapseTwo" class="accordion-body collapse">
            <div class="panel-body">
              {{ pages.luzon.content }}
            </div>
          </div>  

          <div class="panel-heading">
              <a class="accordion-toggle " data-toggle="collapse" data-parent="#accordion2" href="#collapseThree">
                {{ pages.visayas.title }}
              </a>
          </div>

          <div id="collapseThree" class="accordion-body collapse">
            <div class="panel-body">
              {{ pages.visayas.content }}
            </div>
          </div>  

          <div class="panel-heading">
              <a class="accordion-toggle " data-toggle="collapse" data-parent="#accordion2" href="#collapseFour">
                {{ pages.mindanao.title }}
              </a>
          </div>

          <div id="collapseFour" class="accordion-body collapse">
            <div class="panel-body">
              {{ pages.mindanao.content }}
            </div>
          </div>  
        </div>
    </div>
        
        <p class="datalayer-store"><em>Want us to be in your city or home town?<span> </span><a href="https://www.ellanacosmetics.com/pages/ellana-in-your-hometown">Let us know here.</a></em></p>
<p class="datalayer-store">You may also check out your favorite Ellana goodies online at:</p>
        
        <p><a target="_blank" href="https://www.lazada.com.ph/shop-makeup/ellana-mineral-cosmetics/" rel="noopener noreferrer">Lazada</a></p>
        <p><a target="_blank" href="https://shopee.ph/ellanaminerals" rel="noopener noreferrer">Shopee</a></p>
        <p><a target="_blank" href="https://www.zalora.com.ph/ellana-mineral-cosmetics/" rel="noopener noreferrer">Zalora</a></p>
        <p class="datalayer-store"><a target="_blank" href="https://beautymnl.com/brands/ellana-mineral-cosmetics" rel="noopener noreferrer">BeautyMNL</a><span></span></p>
        <p><a target="_blank" href="https://beautybar.com.ph/search?controller=search&amp;orderby=position&amp;orderway=desc&amp;search_query=Ellana+Minerals&amp;submit_search=" rel="noopener noreferrer">BeautyBar.com.ph</a></p>
        <!-- <p><a target="_blank" href="https://www.calyxta.com/product-brands/ellana/" rel="noopener noreferrer">Watsons.com.ph </a></p>
        <p><a target="_blank" href="https://www.calyxta.com/product-brands/ellana/" rel="noopener noreferrer">Calyxta.com</a></p> -->
        <p><a target="_blank" href="https://shoppurebeauty.com/collections/ellana" rel="noopener noreferrer">ShopPureBeauty.com</a></p>
      </div>
    </div>
  </div>
</div>
  </section>



<style>
  .found{
    background-color:yellow;
  }
  .panel-heading {
    padding: 15px;
    border: 1px solid #ececec;
    margin: 15px 0;
  }
  .panel-heading .accordion-toggle {
    margin: 5px 0;
  }
  .accordion-toggle {
    border: none;
    font-weight: 100;
  }
</style>


<script>
  $('#find').click(function(){
    var btn = $(this);
    btn.prop("disabled",true); 
    var term = $('#term').val(); 
    $('.collapse').collapse("hide"); 
    var rd = new RegExp('<span class="found">('+term+')<\/span>', "ig");
    $('#accordion2').html( $('#accordion2').html().replace(rd, '$1' ) ); 
    var occurences=[]; 
    $('#accordion2 .panel-body').each(function(i,e){ 
        var r = new RegExp('('+term+')', "ig"); 
        if( $(this).html().match(r) ){ 
            var matches = $(this).html().match(r); 
            $.each(matches, function(){ 
                occurences.push(i); 
            });
            $(this).html( $(this).html().replace(r, '<span class="found">$1</span>') );  
        }
    });
    var l =occurences.length; 
    var c = Number( $('#current').html() ); 
        c =  c > 0 ? c+1: 0;  
        c =  c > l ? 1 : c; 
        c =  c == 0 && l > 0 ? 1 : c ; 
    $('#count').html( l > 0 ? ' of '+ l : ' matches found in document');  
    $('#current').html( c ); 
    if(c != 0){
        $('#accordion2 .accordion-toggle').eq( occurences[c-1] ).click(); 
        $('.found').eq(c-1).focus()
    }
    setTimeout(function() { btn.prop("disabled",false); }, 1000); 
});

// reset everything if the user starts typing again
$('#term').keydown(function(){
    var term = $('#term').val(); 
    var rd = new RegExp('<span class="found">('+term+')<\/span>', "ig"); 
    $('#accordion2').html( $('#accordion2').html().replace(rd, '$1' ) ); 
    $('#count').html(''); // reset our labels
    $('#current').html('');
});

//$('#find').click(function(){ 
//  setTimeout(function() {
//	$(".found")[0].scrollIntoView({
//      behavior: "smooth", // or "auto" or "instant"
//      block: "start" // or "end"
//	});  
//    }, 1000); 
//}); 

   $(".location-search").append('<a href="#store-listings">See all locations</a>');
</script>

